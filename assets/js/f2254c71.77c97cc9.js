"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[947],{7385:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>c,toc:()=>o});var i=t(4848),s=t(8453);const a={},r="Problems at Redis in microservices",c={id:"blog/25-01-06-problems-at-redis",title:"Problems at Redis in microservices",description:"Cache avalanche",source:"@site/docs/blog/25-01-06-problems-at-redis.md",sourceDirName:"blog",slug:"/blog/25-01-06-problems-at-redis",permalink:"/docs/blog/25-01-06-problems-at-redis",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"T\xecm hi\u1ec3u database management system c\u01a1 b\u1ea3n (part 2)",permalink:"/docs/blog/24-09-11-Database"},next:{title:"Microservice Pattern with example in Java",permalink:"/docs/blog/25-01-07-microservice-pattern"}},l={},o=[{value:"Cache avalanche",id:"cache-avalanche",level:2},{value:"Implement wrong lock",id:"implement-wrong-lock",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"problems-at-redis-in-microservices",children:"Problems at Redis in microservices"})}),"\n",(0,i.jsx)(n.h2,{id:"cache-avalanche",children:"Cache avalanche"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"At a certain moment, all caches expire at the same time or redis fails, causing a large number of requests to database. Database is likely to suspended. If DBA restart the DB, It still can't handle the large number of requests. This is called cache avalanche."}),"\n",(0,i.jsxs)(n.li,{children:["Solution:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use cache with different expiration time."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h1,{id:"cache-breakdown",children:"Cache breakdown"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Cache breakdown is a situation where a cache key is invalidated and a large number of requests are sent to the database to retrieve the data. This is a situation where the cache is not used."}),"\n",(0,i.jsxs)(n.li,{children:["Solution:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Don't set expire time for hotspot key."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h1,{id:"cache-penetration",children:"Cache penetration"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Cache penetration is a situation where a cache key is not found in the cache and a large number of requests are sent to the database to retrieve the data (and don't have in database too)."}),"\n",(0,i.jsxs)(n.li,{children:["Solution:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Write code to handle exceptional case (eg: return null immediately if the key is not valid)."}),"\n",(0,i.jsxs)(n.li,{children:["Use bloom filter to check if the key is in the cache or not.","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["eg: request -> ",(0,i.jsx)(n.code,{children:"[bloom filter]"})," -> ",(0,i.jsx)(n.code,{children:"[cache]"})," -> ",(0,i.jsx)(n.code,{children:"[database]"})," -> response"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"implement-wrong-lock",children:"Implement wrong lock"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img.png",src:t(7523).A+"",width:"742",height:"352"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},7523:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/implement-wrong-lock-04efe5172e0b324f5c47135bb946a4e1.png"},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>c});var i=t(6540);const s={},a=i.createContext(s);function r(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);